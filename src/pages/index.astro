---
import Layout from '../layouts/Layout.astro'

import { profile } from '@/settings'
import { loadYaml } from '@/lib/loadYaml'
import type { Publication } from '@/types/publication'
const ProfilePicture = '/images/profile.png'
import Hero from '@/components/ui/Hero.astro'
import Grid from '@/components/ui/Grid.astro'
import News from '@/components/ui/News.astro'
import { highlightAuthor } from '@/lib/utils'

const { fullName, title, institute, research_areas } = profile

// è«–æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€æœ€æ–°5ä»¶ã‚’å–å¾—
const publications = loadYaml<Publication[]>('publications.yaml');
const recentPublications = publications
	.sort((a, b) => {
		if (b.year !== a.year) return b.year - a.year;
		return (b.month || 0) - (a.month || 0);
	})
	.slice(0, 5);
---

<Layout>
	<!-- Hero Section -->
	<section class='flex items-center gap-12 border-b pb-12'>
		<Hero
			fullName={fullName}
			title={title}
			institute={institute}
			profilePicture={ProfilePicture}
		/>
	</section>

	<!-- News Section -->
	<section class='py-12 border-b'>
		<News limit={5} />
	</section>

	<!-- Research Areas -->
	<section class='py-12 border-b'>
		<Grid gridTitle='Research Areas' gridItems={research_areas} />
	</section>

	<!-- Recent Publications -->
	<section class='py-12'>
		<h2 class='text-2xl font-bold mb-6'>Recent Publications</h2>
		<div class="space-y-4">
			{recentPublications.map((pub) => (
				<div class="card bg-base-200/50 hover:bg-base-200 transition-colors">
					<div class="card-body py-4">
						<h3 class="card-title text-base leading-tight">
							{pub.title}
							{pub.award && (
								<span class="badge badge-error badge-sm ml-2">
									ğŸ† {pub.award}
								</span>
							)}
						</h3>
						<p class="text-sm">
							<span set:html={highlightAuthor(pub.authors)} />
						</p>
						<p class="text-sm text-base-content/70">
							<span class="italic">{pub.venue}</span>
							{' '}({pub.year})
						</p>
					</div>
				</div>
			))}
		</div>
		<div class="mt-6">
			<a href="/papers" class="btn btn-outline btn-primary">
				View All Publications â†’
			</a>
		</div>
	</section>
</Layout>
